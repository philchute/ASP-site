@page "/gundam/grades"
@model ASP_site.Pages.Gunpla.GradesModel
@{
    ViewData["Title"] = "Gunpla Grades";
}

<style>
    .grades-page {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        color: #e0e0e0;
        background-color: #121212;
        padding: 40px;
        min-height: 100vh;
    }
    .content-card {
        background: #1e1e1e;
        border: 1px solid #333;
        padding: 40px;
        border-radius: 8px;
        max-width: 800px;
        margin: 0 auto;
    }
    h1, h2, h3 { color: #00bcd4; margin-top: 1.5em; margin-bottom: 0.5em; }
    h1 { margin-top: 0; font-family: 'Orbitron', sans-serif; border-bottom: 2px solid #333; padding-bottom: 10px; }
    p, li { line-height: 1.6; color: #ccc; }
    strong { color: #fff; }
    a.back-link {
        color: #888;
        text-decoration: none;
        display: inline-block;
        margin-bottom: 20px;
    }
    a.back-link:hover { color: #fff; }
</style>

<div class="grades-page">
    <a asp-page="/Gundam/Dashboard" class="back-link">&larr; Back to Dashboard</a>

    <div class="content-card">
        <div class="text-center mb-4">
            <h3>Browse Kits by Grade</h3>
            <div class="d-flex justify-content-center gap-2 flex-wrap">
                @foreach(var grade in Enum.GetValues(typeof(ASP_site.Models.Gunpla.GunplaGrade)))
                {
                    <a asp-page="/Gundam/Grades/List" asp-route-grade="@grade" class="btn btn-outline-info">@grade List</a>
                }
            </div>
        </div>

        @if (Model.GradeInfo != null)
        {
            <!-- 
               Rendering basic markdown content. 
               Since we don't have the markdown parser exposed as a service yet, 
               we rely on a simple client-side script or raw render if content is simple.
               For now, let's assume the content is simple text or use a simple regex replacer for this view.
            -->
            
            @* Simple Server-side Render for common markdown elements *@
                string html = Model.GradeInfo.Content;
                // Remove FrontMatter
                html = System.Text.RegularExpressions.Regex.Replace(html, @"^---[\s\S]*?---", "");
                
                // Headers
                html = System.Text.RegularExpressions.Regex.Replace(html, @"^### (.*$)", "<h3>$1</h3>", System.Text.RegularExpressions.RegexOptions.Multiline);
                html = System.Text.RegularExpressions.Regex.Replace(html, @"^## (.*$)", "<h2>$1</h2>", System.Text.RegularExpressions.RegexOptions.Multiline);
                
                // Bold
                html = System.Text.RegularExpressions.Regex.Replace(html, @"\*\*(.*?)\*\*", "<strong>$1</strong>");
                
                // Lists
                html = System.Text.RegularExpressions.Regex.Replace(html, @"^\* (.*$)", "<li>$1</li>", System.Text.RegularExpressions.RegexOptions.Multiline);
                
                // Paragraphs (double newline)
                html = System.Text.RegularExpressions.Regex.Replace(html, @"\n\n", "<br/><br/>");
            
            @Html.Raw(html)
        }
        else
        {
            <p>Grade information not found.</p>
        }
    </div>
</div>
